syntax = "proto3"; //指定proto版本
package emoji_rpc;

option go_package = "./emoji_rpc";

// ========== 用户收藏表情同步 ==========
message GetUserEmojiCollectsReq {
  string userId = 1; // 用户ID
  int64 since = 2; // 从这个版本号之后获取变更
}

message GetUserEmojiCollectsRes {
  repeated EmojiCollectVersionItem emojiCollectVersions = 1; // 用户收藏的表情记录变更
  int64 serverTimestamp = 2; // 服务端时间戳
}

// ========== 用户收藏表情包同步 ==========
message GetUserEmojiPackageCollectsReq {
  string userId = 1; // 用户ID
  int64 since = 2; // 从这个版本号之后获取变更
}

message GetUserEmojiPackageCollectsRes {
  repeated EmojiPackageCollectVersionItem emojiPackageCollectVersions = 1; // 用户收藏的表情包变更
  int64 serverTimestamp = 2; // 服务端时间戳
}

// ========== 表情包基础数据同步 ==========
message GetEmojiPackagesReq {
  string userId = 1; // 用户ID（可选，用于权限控制）
  int64 since = 2; // 从这个版本号之后获取变更
}

message GetEmojiPackagesRes {
  repeated EmojiPackageVersionItem emojiPackageVersions = 1; // 表情包基础数据变更
  int64 serverTimestamp = 2; // 服务端时间戳
}

// ========== 表情包内容同步 ==========
message GetEmojiPackageContentsReq {
  string userId = 1; // 用户ID（可选，用于权限控制）
  int64 since = 2; // 从这个版本号之后获取变更
}

message GetEmojiPackageContentsRes {
  repeated EmojiPackageContentVersionItem emojiPackageContentVersions = 1; // 表情包内容变更
  int64 serverTimestamp = 2; // 服务端时间戳
}

// ========== 用户相关表情基础数据同步 ==========
message GetEmojisReq {
  string userId = 1; // 用户ID
  int64 since = 2; // 从这个时间戳之后获取变更
}

message GetEmojisRes {
  repeated EmojiVersionItem emojiVersions = 1; // 用户相关的表情基础数据变更
  int64 serverTimestamp = 2; // 服务端时间戳
}

// 版本摘要数据结构
message EmojiVersionItem {
  string emojiId = 1; // 表情ID
  int64 version = 2; // 版本号
}

message EmojiPackageVersionItem {
  string packageId = 1; // 表情包ID
  int64 version = 2; // 版本号
}

message EmojiPackageContentVersionItem {
  string packageId = 1; // 表情包ID
  int64 version = 2; // 内容版本号
}

message EmojiCollectVersionItem {
  string emojiCollectId = 1; // 表情收藏记录ID
  int64 version = 2; // 版本号
}

message EmojiPackageCollectVersionItem {
  string packageCollectId = 1; // 表情包收藏记录ID
  int64 version = 2; // 版本号
}

service emoji {
  // ========== 用户收藏表情同步 ==========
  rpc GetUserEmojiCollects(GetUserEmojiCollectsReq) returns (GetUserEmojiCollectsRes);

  // ========== 用户收藏表情包同步 ==========
  rpc GetUserEmojiPackageCollects(GetUserEmojiPackageCollectsReq) returns (GetUserEmojiPackageCollectsRes);

  // ========== 表情包基础数据同步 ==========
  rpc GetEmojiPackages(GetEmojiPackagesReq) returns (GetEmojiPackagesRes);

  // ========== 表情包内容同步 ==========
  rpc GetEmojiPackageContents(GetEmojiPackageContentsReq) returns (GetEmojiPackageContentsRes);

  // ========== 表情基础数据同步 ==========
  rpc GetEmojis(GetEmojisReq) returns (GetEmojisRes);
}

// goctl rpc protoc emoji_rpc.proto --go_out=./types --go-grpc_out=./types --zrpc_out=.